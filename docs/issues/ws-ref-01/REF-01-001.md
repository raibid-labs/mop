# REF-01-001: HTTP REST API - Project Setup

## Context
Initialize the HTTP REST API project with Go module, directory structure, and containerization. This establishes the foundation for the product catalog service demonstrating OBI automatic HTTP instrumentation.

## Requirements
- [ ] Initialize Go module (`go mod init github.com/your-org/mop/examples/01-http-api`)
- [ ] Create standardized directory structure (cmd, internal, tests)
- [ ] Set up Go 1.21+ with necessary dependencies
- [ ] Create multi-stage Dockerfile for optimized builds
- [ ] Add .dockerignore for clean builds
- [ ] Create Makefile with common tasks (build, test, lint, docker)
- [ ] Configure golangci-lint for code quality
- [ ] Add basic README with project overview

## Acceptance Criteria
1. `go mod tidy` runs without errors
2. Directory structure follows Go best practices
3. Dockerfile builds successfully and produces < 20MB image
4. `make build` compiles the application
5. `make test` passes (even with no tests yet)
6. `make lint` runs golangci-lint successfully
7. README includes setup instructions and architecture overview

## Clarifying Questions

**Q1: Should we use a specific Go module path convention?**
- Context: Module path affects imports and should be consistent across examples
- Options:
  - A) `github.com/your-org/mop/examples/01-http-api`
  - B) `mop/examples/01-http-api` (local)
  - C) Custom organization path
- Default: Use github.com path pattern for consistency with potential open-sourcing

**Q2: What Go version should we target?**
- Context: eBPF instrumentation may have Go version requirements
- Options:
  - A) Go 1.21 (stable, well-tested)
  - B) Go 1.22 (latest stable)
  - C) Go 1.23 (bleeding edge)
- Default: Go 1.21+ for balance of stability and features

**Q3: Should we include dev tools (air for hot reload)?**
- Context: Developer experience vs production simplicity
- Options:
  - A) Include in dev-dependencies
  - B) Separate dev setup script
  - C) Document but don't include
- Default: Document in README but don't add to core dependencies

## Technical Notes

### Files to Create
```
examples/01-http-api/
├── cmd/
│   └── server/
│       └── main.go              # Application entrypoint
├── internal/
│   ├── handlers/                # HTTP handlers (placeholder)
│   ├── middleware/              # Middleware (placeholder)
│   └── models/                  # Data models (placeholder)
├── tests/                       # Integration tests
├── .dockerignore
├── .golangci.yml                # Linter configuration
├── Dockerfile                   # Multi-stage build
├── Makefile                     # Build automation
├── README.md                    # Project documentation
└── go.mod                       # Go module definition
```

### Dependencies
```go
require (
    github.com/gin-gonic/gin v1.10.0        // HTTP framework
    github.com/stretchr/testify v1.9.0      // Testing
    go.uber.org/zap v1.27.0                 // Structured logging
)
```

### Dockerfile Pattern
```dockerfile
# Build stage
FROM golang:1.21-alpine AS builder
WORKDIR /app
COPY go.* ./
RUN go mod download
COPY . .
RUN CGO_ENABLED=0 go build -ldflags="-s -w" -o /server ./cmd/server

# Runtime stage
FROM alpine:latest
RUN apk --no-cache add ca-certificates
COPY --from=builder /server /server
EXPOSE 8080
CMD ["/server"]
```

### Makefile Targets
- `make build` - Compile the application
- `make test` - Run all tests
- `make lint` - Run golangci-lint
- `make docker-build` - Build Docker image
- `make docker-run` - Run container locally
- `make clean` - Remove build artifacts

### Testing Approach
- Unit tests for future handlers
- Integration tests with testcontainers
- No OBI-specific code (zero instrumentation)

### Integration Points
- None yet (foundation issue)
- Will integrate with WS-REF-01-002 (handlers)

## Definition of Done
- [ ] Go module initialized with all dependencies
- [ ] Directory structure created with placeholder files
- [ ] Dockerfile builds successfully (< 20MB final image)
- [ ] Makefile with all standard targets working
- [ ] golangci-lint configuration present and passing
- [ ] README documents setup, architecture, and goals
- [ ] `make build && make test && make lint` all pass
- [ ] Docker image runs without errors
- [ ] Code reviewed for Go best practices
- [ ] PR merged to main branch

## Related Issues
- Blocks: REF-01-002 (HTTP handlers need project structure)
- Blocks: REF-01-003 (Middleware needs project structure)
- Related: REF-02-001 (gRPC setup - similar patterns)

## Labels
`workstream:ws-ref-01`, `priority:critical`, `status:new`, `type:setup`, `protocol:http`
